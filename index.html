<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PEACE N' LOVE - Salam√°</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #00ff88;
            --beginner: #ffcc00;
            --bg: #0a0a0a;
            --card: rgba(25, 25, 25, 0.95);
            --text: #ffffff;
            --muted: #888;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg);
            background-image: radial-gradient(circle at top right, #1a1a1a, #0a0a0a);
            color: var(--text);
            margin: 0;
            padding: 20px 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .card {
            background: var(--card);
            width: 100%;
            max-width: 420px;
            padding: 30px;
            border-radius: 40px;
            border: 1px solid #333;
            box-shadow: 0 30px 60px rgba(0,0,0,0.7);
            backdrop-filter: blur(20px);
            box-sizing: border-box;
        }

        .card.beginner-mode { border-color: var(--beginner); }

        .header { text-align: center; margin-bottom: 25px; }
        .logo-container {
            width: 80px; height: 80px;
            margin: 0 auto 10px;
            background: #111;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #222;
        }
        .logo-container i { font-size: 2rem; color: var(--primary); }

        .header h1 { margin: 0; font-size: 1.5rem; font-weight: 900; }
        .header p { margin: 5px 0 0; font-size: 0.7rem; font-weight: 800; color: var(--primary); text-transform: uppercase; letter-spacing: 2px; }

        .mode-selector {
            display: flex; align-items: center; justify-content: space-between;
            background: rgba(255,255,255,0.05);
            padding: 10px 18px; border-radius: 20px; margin-bottom: 20px;
        }

        .switch { position: relative; width: 44px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #444; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background: var(--beginner); }
        input:checked + .slider:before { transform: translateX(22px); }

        .input-box { margin-bottom: 12px; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px; }
        label { display: block; font-size: 0.6rem; font-weight: 800; color: var(--muted); text-transform: uppercase; margin-bottom: 6px; margin-left: 4px; }
        
        input, select {
            width: 100%; background: #151515; border: 2px solid #222; color: white;
            padding: 12px; border-radius: 15px; font-size: 0.95rem; box-sizing: border-box; outline: none;
        }
        input:focus { border-color: var(--primary); }

        .btn-main {
            width: 100%; padding: 18px; background: white; color: black; border: none;
            border-radius: 18px; font-weight: 900; font-size: 1rem; cursor: pointer; text-transform: uppercase; margin-top: 5px;
        }

        #result-box {
            display: none; margin-top: 20px; padding: 20px; border-radius: 25px;
            background: rgba(255,255,255,0.02); border: 1px solid var(--primary); text-align: center;
        }

        .price-tag { font-size: 3rem; font-weight: 900; color: var(--primary); margin: 0; }
        .session-info { font-size: 0.85rem; color: var(--beginner); margin: 5px 0 15px; font-weight: 700; }
        .sub-price { font-size: 0.8rem; color: var(--muted); margin-bottom: 15px; }

        .action-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn-action { border: none; padding: 12px; border-radius: 12px; font-weight: 800; cursor: pointer; font-size: 0.75rem; }
        .btn-wa { background: #25D366; color: white; }
        .btn-cp { background: #333; color: white; }
        .btn-qr-gen { grid-column: span 2; background: #6c5ce7; color: white; }

        #qr-box { display: none; background: white; padding: 15px; border-radius: 20px; margin-top: 15px; }

        .history-section { width: 100%; max-width: 420px; margin-top: 25px; }
        .h-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .h-header h3 { font-size: 0.75rem; color: var(--muted); margin: 0; }
        .history-card { background: #151515; padding: 12px; border-radius: 15px; margin-bottom: 8px; display: flex; justify-content: space-between; border-left: 4px solid var(--primary); font-size: 0.8rem; }

        .btn-after { background: transparent; border: 1px solid #333; color: var(--muted); padding: 12px; border-radius: 15px; width: 100%; max-width: 420px; margin: 25px 0; cursor: pointer; font-weight: 700; font-size: 0.75rem; }
    </style>
</head>
<body>

<div class="card" id="mainCard">
    <div class="header">
        <div class="logo-container">
            <i class="fas fa-ink-pen"></i>
        </div>
        <h1>PEACE N' LOVE</h1>
        <h1>Tattoo Studio</h1>
        <p id="status-label">Salam√° ‚Ä¢ Cotizador Pro</p>
    </div>

    <div class="mode-selector">
        <span style="font-size: 0.65rem; font-weight: 900;">MODO PRO</span>
        <label class="switch">
            <input type="checkbox" id="beginnerToggle" onchange="updateUI()">
            <span class="slider"></span>
        </label>
        <span style="font-size: 0.65rem; font-weight: 900; color: var(--beginner)">SPECIAL LIGHT</span>
    </div>

    <div class="input-box">
        <label>üë§ Nombre del Cliente</label>
        <input type="text" id="clientName" placeholder="Escribe el nombre del cliente">
    </div>

    <div class="form-grid">
        <div class="input-box">
            <label>üí∞ Moneda</label>
            <select id="currency"><option value="Q">GTQ (Q)</option><option value="$">USD ($)</option></select>
        </div>
        <div class="input-box">
            <label>üìè Tama√±o (cm)</label>
            <input type="number" id="size" placeholder="cm" inputmode="numeric">
        </div>
    </div>

    <div class="form-grid">
        <div class="input-box">
            <label>üé® Estilo</label>
            <select id="style">
                <option value="1.0">L√≠nea Fina</option>
                <option value="1.3">Ilustrativo</option>
                <option value="1.5">Blackwork</option>
                <option value="1.8">Realismo</option>
            </select>
        </div>
        <div class="input-box">
            <label>üìÖ Sesiones</label>
            <select id="sessions">
                <option value="1">1 Sesi√≥n</option>
                <option value="2">2 Sesiones</option>
                <option value="3">3 Sesiones</option>
                <option value="4">4 Sesiones</option>
            </select>
        </div>
    </div>

    <div class="input-box">
        <label>üìç Zona del Cuerpo</label>
        <input type="text" id="area" list="body-list" placeholder="Selecciona la zona">
        <datalist id="body-list">
            <option value="Antebrazo"><option value="Brazo"><option value="Mu√±eca"><option value="Cuello"><option value="Pecho"><option value="Espalda"><option value="Costillas"><option value="Muslo"><option value="Pantorrilla"><option value="Tobillo"><option value="Mano"><option value="Dedos">
        </datalist>
    </div>

    <div class="form-grid">
        <div class="input-box">
            <label>‚ú® Dise√±o</label>
            <select id="custom"><option value="0">Cat√°logo</option><option value="150">Personalizado (+150)</option></select>
        </div>
        <div class="input-box">
            <label>üîÑ Cover Up</label>
            <select id="cover"><option value="1.0">No</option><option value="1.4">S√≠ (+40%)</option></select>
        </div>
    </div>

    <button class="btn-main" onclick="calculate()">GENERAR COTIZACI√ìN</button>

    <div id="result-box">
        <div class="price-tag" id="res-price">Q0</div>
        <div class="session-info" id="res-session-detail"></div>
        <div class="sub-price" id="res-dep">Reserva con: <strong>Q0</strong></div>
        
        <div class="action-grid">
            <button class="btn-action btn-wa" onclick="sendWhatsApp()">WhatsApp üì≤</button>
            <button class="btn-action btn-cp" id="btnCopy" onclick="copyQuote()">Copiar üìã</button>
            <button class="btn-action btn-qr-gen" onclick="showQR()">MOSTRAR C√ìDIGO QR üî≥</button>
        </div>

        <div id="qr-box">
            <canvas id="qr-canvas"></canvas>
            <p style="color:black; font-size:0.65rem; font-weight:800; margin-top:8px;">ESCANEA PARA RECIBIR COTIZACI√ìN</p>
        </div>
    </div>
</div>

<div class="history-section">
    <div class="h-header">
        <h3>RECIENTES</h3>
        <button onclick="clearHistory()" style="background:none; border:none; color:red; font-size:0.6rem; font-weight:800; cursor:pointer;">BORRAR</button>
    </div>
    <div id="history-list"></div>
</div>

<button class="btn-after" onclick="copyAftercare()">üìã Instrucciones de Cuidados (Aftercare)</button>

<script>
    let currentData = {};

    function updateUI() {
        const isLight = document.getElementById('beginnerToggle').checked;
        const lbl = document.getElementById('status-label');
        lbl.innerText = isLight ? "Salam√° ‚Ä¢ Special Light" : "Salam√° ‚Ä¢ Cotizador Pro";
        lbl.style.color = isLight ? "var(--beginner)" : "var(--primary)";
        document.getElementById('mainCard').classList.toggle('beginner-mode', isLight);
        document.getElementById('result-box').style.display = 'none';
    }

    function calculate() {
        const size = parseFloat(document.getElementById('size').value);
        if(!size) return alert("Por favor, ingresa el tama√±o.");

        const isLight = document.getElementById('beginnerToggle').checked;
        const styleFactor = parseFloat(document.getElementById('style').value);
        const extra = parseFloat(document.getElementById('custom').value);
        const coverFactor = parseFloat(document.getElementById('cover').value);
        const numSessions = parseInt(document.getElementById('sessions').value);
        const currency = document.getElementById('currency').value;
        const name = document.getElementById('clientName').value;

        let hours = size > 18 ? 5 : (size > 10 ? 3 : (size > 5 ? 2 : 1));
        let baseRate = isLight ? 150 : 250; 
        let total = (baseRate * hours * styleFactor * coverFactor) + extra;

        if(currency === '$') total = total / 7.8;
        total = Math.ceil(total / 10) * 10;
        
        let deposit = Math.ceil((total * 0.5) / 5) * 5;
        let perSession = Math.ceil((total / numSessions) / 5) * 5;

        currentData = { 
            total, deposit, size, hours, currency, 
            area: document.getElementById('area').value || "la zona elegida", 
            isLight, name, numSessions, perSession 
        };

        document.getElementById('res-price').innerText = `${currency}${total}`;
        
        const sessionDetail = document.getElementById('res-session-detail');
        if(numSessions > 1) {
            sessionDetail.innerText = `${numSessions} sesiones de ${currency}${perSession}`;
            sessionDetail.style.display = 'block';
        } else {
            sessionDetail.style.display = 'none';
        }

        document.getElementById('res-dep').innerHTML = `Anticipo reserva: <strong>${currency}${deposit}</strong>`;
        document.getElementById('result-box').style.display = 'block';
        document.getElementById('qr-box').style.display = 'none';
        saveHistory(currentData);
    }

    function getMsg() {
        const tag = currentData.isLight ? "Precio Especial üè∑Ô∏è\n" : "";
        const hLabel = currentData.hours === 1 ? 'hora' : 'horas';
        const greeting = currentData.name ? `¬°Hola ${currentData.name}! üôå` : "¬°Hola! üôå";
        
        let sessionMsg = "";
        if(currentData.numSessions > 1) {
            sessionMsg = `\nüìÖ Inversi√≥n por sesi√≥n: *${currentData.numSessions} sesiones de ${currentData.currency}${currentData.perSession}*`;
        }

        return `${greeting} Aqu√≠ tienes la cotizaci√≥n para tu tatuaje:\n\n${tag}üìè Medida: ${currentData.size}cm aprox.\nüìç Zona: ${currentData.area}\n‚è±Ô∏è Duraci√≥n: ${currentData.hours} ${hLabel} aprox.\nüí∞ Precio Total: *${currentData.currency}${currentData.total}*${sessionMsg}\nüìå Reserva con: *${currentData.currency}${currentData.deposit}*\n\n‚ú® Incluye: Material profesional descartable, higiene de grado m√©dico y retoque.\n\nüìÖ ¬øTe gustar√≠a agendar una fecha?`;
    }

    function showQR() {
        const box = document.getElementById('qr-box');
        box.style.display = 'block';
        new QRious({
            element: document.getElementById('qr-canvas'),
            value: `https://wa.me/?text=${encodeURIComponent(getMsg())}`,
            size: 200, level: 'H'
        });
        box.scrollIntoView({ behavior: 'smooth' });
    }

    function saveHistory(data) {
        let h = JSON.parse(localStorage.getItem('pnl_history') || '[]');
        h.unshift(data);
        localStorage.setItem('pnl_history', JSON.stringify(h.slice(0, 5)));
        renderHistory();
    }

    function renderHistory() {
        const h = JSON.parse(localStorage.getItem('pnl_history') || '[]');
        document.getElementById('history-list').innerHTML = h.map(i => `
            <div class="history-card" style="border-color:${i.isLight ? 'var(--beginner)':'var(--primary)'}">
                <span>${i.name ? i.name : i.size+'cm'} - ${i.area}</span>
                <strong style="color:${i.isLight ? 'var(--beginner)':'var(--primary)'}">${i.currency}${i.total}</strong>
            </div>
        `).join('');
    }

    function clearHistory() { if(confirm("¬øBorrar historial?")) { localStorage.removeItem('pnl_history'); renderHistory(); } }
    function sendWhatsApp() { window.open(`https://wa.me/?text=${encodeURIComponent(getMsg())}`, '_blank'); }
    function copyQuote() { copyText(getMsg(), "btnCopy", "COPIADO ‚úÖ"); }
    
    function copyAftercare() {
        const care = `‚ú® CUIDADOS POSTERIORES ‚ú®\n\n1. Retirar el parche en 2-4 horas. üßº\n2. Lavar con jab√≥n neutro y agua fr√≠a.\n3. Secar a toques con papel desechable. üßª\n4. Aplicar pomada recomendada 3 veces al d√≠a. üß¥\n5. No sol, piscina o gym por 15 d√≠as. üö´\n6. No rascar la zona.`;
        copyText(care, null, null);
        alert("Instrucciones de cuidado copiadas!");
    }

    function copyText(txt, id, success) {
        const temp = document.createElement('textarea'); temp.value = txt;
        document.body.appendChild(temp); temp.select(); document.execCommand('copy');
        document.body.removeChild(temp);
        if(id) { 
            const b = document.getElementById(id); const orig = b.innerText; 
            b.innerText = success; setTimeout(() => b.innerText = orig, 2000); 
        }
    }
    renderHistory();
</script>
</body>
</html>

